const registroProducto=document.querySelector("#registro_producto_mercado");function mostrarMensaje(t){t.preventDefault();validarCampos()&&Swal.fire({title:"Registrar Producto?",icon:"question",showCancelButton:"Cancelar",confirmButtonText:"Guardar"}).then(e=>{e.isConfirmed&&(Swal.fire("Guardado con exito!","","success"),registerProduct(t))})}function validarCampos(){return!!document.querySelector("#producto").value||(Swal.fire("Falta informaciÃ³n!","","error"),!1)}async function registerProduct(){try{const t=new FormData(registroProducto);t.append("producto",registroProducto[0].value.toLowerCase()),t.append("marca",registroProducto[1].value.toLowerCase()),t.append("cantidad",registroProducto[2].value),t.append("categoria",registroProducto[3].value.toLowerCase()),t.append("observacion",registroProducto[4].value.toLowerCase());const e="http://localhost:3000/API/registro-producto",o=await fetch(e,{method:"POST",body:t});await o.json()&&setTimeout(()=>{document.querySelector(".swal2-container").remove();document.querySelectorAll('input[type="text"], input[type="number"]').forEach((function(t){t.value=""}))},2e3)}catch(t){Swal.fire("Error!","","error")}}let productos;registroProducto&&registroProducto.addEventListener("submit",(function(t){mostrarMensaje(t)}));const listaSelect=document.querySelector("#option-list-select");function offLoader(){const t=document.querySelector(".loader-page");t&&t.remove()}async function obtenerProductos(){try{const t="http://localhost:3000/API/obtener-producto",e=await fetch(t),o=await e.json();o&&(offLoader(),productos=[...o],limpiarLista(),ordenarProductos(o))}catch(t){console.log(t)}}function ordenarProductos(t){t.sort((t,e)=>t.producto<e.producto?-1:t.producto>e.producto?1:t.producto===e.producto?0:void 0),mostrarListas(t)}function mostrarListas(t){const e=document.querySelector("#lista_articulos");t.forEach((function(t){const o=document.createElement("LI"),a=document.createElement("LI"),r=document.createElement("DIV"),c=document.createElement("DIV"),n=document.createElement("LABEL"),i=document.createElement("IMG"),d=document.createElement("INPUT"),s=document.createElement("DIV");o.classList.add("articulos"),r.classList.add("div-product"),c.classList.add("div-icono"),n.classList.add("label-producto"),i.classList.add("img-categoria"),s.classList.add("editar-producto"),n.textContent=t.producto,n.setAttribute("for",t.producto),i.src=`build/img/${t.producto}.webp`,i.onerror=function(t){imagenDefault(t)},d.setAttribute("type","checkbox"),d.setAttribute("name",t.producto),s.onclick=function(){console.log(t),editar(t)},r.appendChild(d),r.appendChild(n),c.appendChild(i),o.appendChild(r),a.appendChild(c),e.appendChild(o),e.appendChild(a),e.appendChild(s)}))}function imagenDefault(t){t.target.src="build/img/default.webp"}function filtrar(){limpiarLista();let t=[];productos.forEach(e=>{(e.categoria===listaSelect.value||"todos"===listaSelect.value)&&t.push(e)}),ordenarProductos(t)}function limpiarLista(){const t=document.querySelector("#lista_articulos");if(t)for(;t.firstChild;)t.removeChild(t.firstChild)}listaSelect&&listaSelect.addEventListener("change",(function(){filtrar()})),document.addEventListener("DOMContentLoaded",(function(){listaSelect&&obtenerProductos()}));const navBtn=document.querySelector("#home-btn");if(navBtn){const t=document.querySelector(".aside");navBtn.addEventListener("click",(function(){t.classList.toggle("mostrar")})),t.addEventListener("click",(function(){t.classList.remove("mostrar"),t.classList.add("ocultar"),setTimeout(()=>{t.classList.remove("ocultar")},1e3)}))}async function editar(t){const{value:e}=await Swal.fire({title:"Actualizar Producto",html:`<form id="updateForm" method="POST" class="updateForm"><label for="producto">Producto</label><input name="producto" id="swal-input1" class="swal2-input"><label for="marca">Marca</label><input name="marca" id="swal-input2" class="swal2-input"><label for="categoria">Categoria</label><input name="categoria" id="swal-input3" class="swal2-input"><input type="hidden" name="id" value=${t.id} ></form>`}),o=document.querySelector("#updateForm"),a=new FormData;if(a.append("producto",o[0].value.toLowerCase()),a.append("marca",o[1].value.toLowerCase()),a.append("categoria",o[2].value.toLowerCase()),a.append("id",o[3].value),e)try{Swal.fire({title:"Actualizar Producto?",icon:"question",showCancelButton:"Cancelar",confirmButtonText:"Guardar"}).then(t=>{t.isConfirmed&&finalizarEdicion(a)})}catch(t){console.log(t)}}async function finalizarEdicion(t){const e=await fetch("http://localhost:3000/API/editar-producto",{method:"POST",body:t});await e.json()&&(Swal.fire("Actualizado con exito!","","success"),limpiarLista(),obtenerProductos())}