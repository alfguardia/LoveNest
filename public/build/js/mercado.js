const registroProducto=document.querySelector("#registro_producto_mercado");function mostrarMensaje(t){t.preventDefault();validarCampos()&&Swal.fire({title:"Registrar Producto?",icon:"question",showCancelButton:"Cancelar",confirmButtonText:"Guardar"}).then(e=>{e.isConfirmed&&(Swal.fire("Guardado con exito!","","success"),registerProduct(t))})}function validarCampos(){return!!document.querySelector("#producto").value||(Swal.fire("Falta informaciÃ³n!","","error"),!1)}async function registerProduct(){try{const t=new FormData(registroProducto);t.append("producto",registroProducto[0].value.toLowerCase()),t.append("marca",registroProducto[1].value.toLowerCase()),t.append("cantidad",registroProducto[2].value),t.append("categoria",registroProducto[3].value.toLowerCase()),t.append("observacion",registroProducto[4].value.toLowerCase());const e="https://lovenest-app.herokuapp.com/API/registro-producto",o=await fetch(e,{method:"POST",body:t});await o.json()&&setTimeout(()=>{document.querySelector(".swal2-container").remove();document.querySelectorAll('input[type="text"], input[type="number"]').forEach((function(t){t.value=""}))},2e3)}catch(t){Swal.fire("Error!","","error")}}let productos;registroProducto&&registroProducto.addEventListener("submit",(function(t){mostrarMensaje(t)}));const listaSelect=document.querySelector("#option-list-select");function offLoader(){const t=document.querySelector(".loader-page");t&&t.remove()}async function obtenerProductos(){try{const t="https://lovenest-app.herokuapp.com/API/obtener-producto",e=await fetch(t),o=await e.json();console.log(o),o&&(offLoader(),productos=[...o],limpiarLista(),ordenarProductos(o))}catch(t){console.log(t)}}function ordenarProductos(t){t.sort((t,e)=>t.producto<e.producto?-1:t.producto>e.producto?1:t.producto===e.producto?0:void 0),mostrarListas(t)}function mostrarListas(t){const e=document.querySelector("#lista_articulos");t.forEach((function(t){const o=document.createElement("LI"),a=document.createElement("LI"),r=document.createElement("LI"),n=document.createElement("DIV"),c=document.createElement("DIV"),i=document.createElement("LABEL"),d=document.createElement("IMG"),l=document.createElement("INPUT"),s=document.createElement("DIV"),u=document.createElement("DIV"),p=document.createElement("DIV"),m=document.createElement("P");o.classList.add("articulos"),n.classList.add("div-product"),c.classList.add("div-icono"),i.classList.add("label-producto"),d.classList.add("img-categoria"),s.classList.add("editar-producto"),u.classList.add("eliminar-producto"),p.classList.add("opciones"),m.style.color="black",m.style.fontWeight="bold",m.textContent=t.cantidad,i.textContent=t.producto,i.setAttribute("for",t.producto),d.src=`build/img/${t.producto}.webp`,d.onerror=function(t){imagenDefault(t)},l.setAttribute("type","checkbox"),l.setAttribute("name",t.producto),s.onclick=()=>{confirmarEdicion(t)},u.onclick=()=>{confirmarEliminar(t)},n.appendChild(l),n.appendChild(i),c.appendChild(d),o.appendChild(n),a.appendChild(c),r.appendChild(m),p.appendChild(s),p.appendChild(u),e.appendChild(o),e.appendChild(a),e.appendChild(r),e.appendChild(p)}))}function imagenDefault(t){t.target.src="build/img/default.webp"}function filtrar(){limpiarLista();let t=[];productos.forEach(e=>{(e.categoria===listaSelect.value||"todos"===listaSelect.value)&&t.push(e)}),ordenarProductos(t)}function limpiarLista(){const t=document.querySelector("#lista_articulos");if(t)for(;t.firstChild;)t.removeChild(t.firstChild)}async function confirmarEdicion(t){const{value:e}=await Swal.fire({title:"Actualizar Producto",html:`<form id="updateForm" method="POST" class="updateForm"><label for="producto">Producto</label><input name="producto" id="swal-input1" class="swal2-input"><label for="cantidad">Cantidad</label><input name="cantidad" id="swal-input2" class="swal2-input"><label for="marca">Marca</label><input name="marca" id="swal-input3" class="swal2-input"><label for="categoria">Categoria</label><input name="categoria" id="swal-input4" class="swal2-input"><input type="hidden" name="id" value=${t.id} ></form>`}),o=document.querySelector("#updateForm"),a=new FormData;if(a.append("producto",o[0].value.toLowerCase()),a.append("cantidad",o[1].value),a.append("marca",o[2].value.toLowerCase()),a.append("categoria",o[3].value.toLowerCase()),a.append("id",o[4].value),e)try{Swal.fire({title:"Actualizar Producto?",icon:"question",showCancelButton:"Cancelar",confirmButtonText:"Guardar"}).then(t=>{t.isConfirmed&&finalizarEdicion(a)})}catch(t){console.log(t)}}async function finalizarEdicion(t){const e=await fetch("https://lovenest-app.herokuapp.com/API/editar-producto",{method:"POST",body:t});await e.json()&&(Swal.fire("Actualizado con exito!","","success"),limpiarLista(),obtenerProductos())}async function confirmarEliminar(t){try{Swal.fire({title:"Eliminar Producto?",icon:"question",showCancelButton:"Cancelar",confirmButtonText:"Eliminar"}).then(e=>{e.isConfirmed&&eliminar(t)})}catch(t){console.log(t)}}async function eliminar(t){const e=new FormData;e.append("id",t.id);try{const t="https://lovenest-app.herokuapp.com/API/eliminar-producto",o=await fetch(t,{method:"POST",body:e});await o.json()&&(Swal.fire("Producto eliminado!","","success"),limpiarLista(),obtenerProductos())}catch(t){console.log(t)}}listaSelect&&listaSelect.addEventListener("change",(function(){filtrar()})),document.addEventListener("DOMContentLoaded",(function(){listaSelect&&obtenerProductos()}));